/**
 * Created by brugnara on 08/07/16,
 * @ daniele@brugnara.me
 */

'use strict';

var Debug = require('debug');

const DEFAULT_SCOPE = 'corso:error-handler';

module.exports = function (options) {

  options = options || {};

  var debug = Debug(options.scope || DEFAULT_SCOPE);

  return function*(next) {
    try {
      debug('trying to yield next...');
      yield next;
    } catch(err) {
      debug('ouch!');
      this.body = 'ERRORE: ' + err.message;
    }
  }

};
